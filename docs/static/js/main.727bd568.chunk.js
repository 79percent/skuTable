(this.webpackJsonphancock=this.webpackJsonphancock||[]).push([[0],{442:function(e,t,n){},443:function(e,t,n){},444:function(e,t,n){},573:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),l=n(52),c=n.n(l),u=(n(442),n(443),n(31)),o=n(12),s=n(19),d=n(8),v=n(2),b=n(7),p=n(3),f=n(351),j=n(228),h=n(585),O=n(119),m=n(588),g=n(347),x=n(58),y=n(401),k=n(331),w=function(e){for(var t="",n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",a=0;a<e;a++){t+=n[Math.floor(62*Math.random())]}return t},V=[{label:"\u578b\u53f7",value:0,attrValue:[{label:"iPhone 12",value:10},{label:"iPhone 13",value:11},{label:"iPhone 14",value:12}]},{label:"\u989c\u8272",value:1,attrValue:[{label:"\u9ed1\u8272",value:13},{label:"\u7ea2\u8272",value:14},{label:"\u84dd\u8272",value:15}]},{label:"\u5185\u5b58",value:2,attrValue:[{label:"32G",value:16},{label:"64G",value:17},{label:"128G",value:18}]}],I=function(e){return(a=a||Object(s.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=V.find((function(e){return e.value===t})),e.abrupt("return",(null===n||void 0===n?void 0:n.attrValue)||[]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},P=(n(444),n(426)),A=n(4),C=["chileren"],L=[{title:"\u9500\u552e\u4ef7",dataIndex:"oprice",valueType:"digit",fieldProps:{addonAfter:"\u5143",min:0}},{title:"\u6210\u672c\u4ef7",dataIndex:"cprice",valueType:"digit",fieldProps:{addonAfter:"\u5143",min:0}},{title:"\u5e93\u5b58",dataIndex:"stock",valueType:"digit",fieldProps:{min:0}}];function S(){var e,t,n=g.a.useForm(),a=Object(p.a)(n,1)[0],i=g.a.useForm(),l=Object(p.a)(i,1)[0],c=Object(r.useState)(null),u=Object(p.a)(c,2),S=u[0],F=u[1],N=Object(r.useState)([]),T=Object(p.a)(N,2),_=T[0],E=T[1],q=Object(r.useState)([]),B=Object(p.a)(q,2),D=B[0],G=B[1],M=Object(r.useState)([]),J=Object(p.a)(M,2),K=J[0],R=J[1],z=Object(r.useState)({show:!1,msg:""}),H=Object(p.a)(z,2),Q=H[0],U=H[1],W=D.map((function(e){return null===e||void 0===e?void 0:e.id}));console.log(D);var X=[].concat(Object(b.a)(K),L),Y=function(e,t){for(var n=e||(null===a||void 0===a?void 0:a.getFieldsValue()),r=(t||_).map((function(e,t){var a="attrName_".concat(e),r="attrValue_".concat(e),i=n[a],l=n[r]||[];return{attrName:i,attrValue:l=l.map((function(e){return Object(v.a)(Object(v.a)({},e.value),{},{chileren:[]})}))}})).map((function(e,t){return e.attrValue})),i=r.length-1,l=function(){var e=r[i];r[i-1].forEach((function(t){t.chileren=e})),i--};i>=1;)l();var c=r[0]||[],u=[];function o(e,t){var n=e.chileren,a=Object(d.a)(e,C);t.push(a),Array.isArray(n)&&n.length>0?n.forEach((function(e){o(e,Object(b.a)(t))})):u.push(t)}return c.forEach((function(e){o(e,[])})),console.log("skuData",u),u},Z=function(e,t){var n=Y(),a=[];if(0===n.length)a=D.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{skuList:[]})}));else{var r=-1;a=n.map((function(e,t){var n=D.find((function(t,n){var a=t.skuList||[];if(0===a.length){var i=r;return r=n,n>i}var l=e.length===a.length&&e.every((function(e,t){var n;return(null===e||void 0===e?void 0:e.value)===(null===(n=a[t])||void 0===n?void 0:n.value)})),c=r;return r=n,n>c&&l}));return Object(v.a)(Object(v.a)({},n),{},{skuList:e})}))}if(0===a.length){var i=w(20);G([{id:i,oprice:void 0,cprice:void 0,stock:void 0}])}else G(a)},$=function(){return(t=t||Object(s.a)(Object(o.a)().mark((function e(){var t,n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){return"undefined"===typeof e||""===e},e.next=3,a.validateFields();case 3:if(0!==D.length){e.next=7;break}return U({show:!0,msg:t="\u8bf7\u81f3\u5c11\u6dfb\u52a0\u4e00\u4e2a\u89c4\u683c"}),e.abrupt("return",Promise.reject(t));case 7:if(!D.some((function(e){var t=e.oprice,a=e.cprice,r=e.stock,i=e.skuList;return!Array.isArray(i)||0===i.length||i.length!==_.length||n(t)||n(a)||n(r)}))){e.next=12;break}return U({show:!0,msg:r="\u8bf7\u6dfb\u52a0\u89c4\u683c\u503c\u3001\u9500\u552e\u4ef7\u3001\u6210\u672c\u4ef7\u3001\u5e93\u5b58"}),e.abrupt("return",Promise.reject(r));case 12:return U({show:!1,msg:""}),e.abrupt("return",Promise.resolve(!0));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)};return Object(A.jsxs)(f.a,{children:[Object(A.jsxs)(j.a,{form:a,layout:"horizontal",onValuesChange:function(e,t){F(t)},labelCol:{span:4},wrapperCol:{span:16},submitter:!1,children:[_.map((function(e,t){var n,r,i,l,c="attrName_".concat(e),u="attrValue_".concat(e);return Object(A.jsxs)("div",{className:"attrCard",children:[Object(A.jsx)(h.a,{label:"\u89c4\u683c\u540d",name:c,allowClear:!1,fieldProps:{labelInValue:!0,onSelect:function(e){return function(e,t){var n=Object(b.a)(K);n[t].title=e.label,n[t].dataIndex=e.value,R(n)}(e,t)},onChange:function(){a.getFieldsValue();null===a||void 0===a||a.resetFields([u])}},initialValue:void 0,request:Object(s.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.map((function(e){return{label:e.label,value:e.value}})));case 1:case"end":return e.stop()}}),e)}))),style:{width:200},rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u89c4\u683c\u540d"}]}),Object(A.jsx)(j.a.Item,{isListField:!0,label:"\u89c4\u683c\u503c",wrapperCol:{span:16},children:Object(A.jsx)(O.b,{name:u,creatorButtonProps:{creatorButtonText:"\u6dfb\u52a0",icon:!1,type:"link",disabled:!(null!==S&&void 0!==S&&null!==(n=S[u])&&void 0!==n&&n.every((function(e){return null===e||void 0===e?void 0:e.value}))),style:{width:"unset"}},min:1,initialValue:[{value:void 0}],onAfterRemove:Z,copyIconProps:!1,deleteIconProps:(null===S||void 0===S||null===(r=S[u])||void 0===r?void 0:r.length)>1&&{tooltipText:"\u5220\u9664"},itemRender:function(e){var t=e.listDom,n=e.action;return Object(A.jsxs)("div",{style:{display:"inline-flex",marginInlineEnd:25},children:[t,n]})},children:Object(A.jsx)(h.a,{name:["value"],fieldProps:{allowClear:!1,labelInValue:!0,onSelect:function(e){return function(e,t){var n=Y(),a=-1;G(n.map((function(t,n){var r=t.filter((function(t){return t.value!==e.value})),i=D.find((function(e,t){var n=e.skuList||[];if(0===n.length)return!0;var i=r.length===n.length&&r.every((function(e,t){var a;return(null===e||void 0===e?void 0:e.value)===(null===(a=n[t])||void 0===a?void 0:a.value)})),l=a;return a=t,t>l&&i}));return Object(v.a)(Object(v.a)({id:w(20),oprice:void 0,cprice:void 0,stock:void 0},i),{},{skuList:t})})))}(e)},onDeselect:function(e){return Z()}},params:{attrNameValue:null===S||void 0===S||null===(i=S[c])||void 0===i?void 0:i.value},request:function(e){return(l=l||Object(s.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I(null===t||void 0===t?void 0:t.attrNameValue));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},style:{width:200},rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u89c4\u683c\u503c"}]})})}),Object(A.jsx)(x.a,{type:"primary",danger:!0,className:"deleteAttr",onClick:function(){return function(e){var t=Object(b.a)(K);t.splice(e,1),t=t.map((function(e,t){return Object(v.a)(Object(v.a)({},e),{},{dataIndex:"#".concat(t),render:function(e,n){var a,r=n.skuList;return Array.isArray(r)&&(null===(a=r[t])||void 0===a?void 0:a.label)||"-"}})})),R(t);var n=Object(b.a)(_);if(n.splice(e,1),E(n),0===n.length)G([]);else{var r="attrName_".concat(_[e]),i="attrValue_".concat(_[e]),l=null===a||void 0===a?void 0:a.getFieldsValue();delete l[r],delete l[i];var c=Y(l,n),u=Object(b.a)(D);u.map((function(t){var n=(null===t||void 0===t?void 0:t.skuList)||[];return n=n.splice(e,1),Object(v.a)(Object(v.a)({},t),{},{skuList:n})})),u=c.map((function(e){return u.find((function(t){var n=(null===t||void 0===t?void 0:t.skuList)||[];return n.length===e.length&&e.every((function(e,t){var a;return(null===e||void 0===e?void 0:e.value)===(null===(a=n[t])||void 0===a?void 0:a.value)}))}))})),G(u)}}(t)},children:"\u5220\u9664\u89c4\u683c\u9879"})]},e)})),Object(A.jsx)(j.a.Item,{label:"",wrapperCol:{span:24},children:Object(A.jsx)(x.a,{type:"dashed",icon:Object(A.jsx)(P.a,{}),style:{width:"100%"},onClick:function(){return(e=e||Object(s.a)(Object(o.a)().mark((function e(){var t,n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.validateFields();case 2:t="new_".concat(w(20)),n=_.length,E([].concat(Object(b.a)(_),[t])),R([].concat(Object(b.a)(K),[{title:"#",dataIndex:"#".concat(n),editable:!1,render:function(e,t){var a,r=t.skuList;return Array.isArray(r)&&(null===(a=r[n])||void 0===a?void 0:a.label)||"-"}}])),0===D.length&&(r=w(20),G([{id:r,oprice:void 0,cprice:void 0,stock:void 0,skuList:[]}]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},children:"\u6dfb\u52a0\u89c4\u683c\u9879"})})]}),Object(A.jsx)(m.a,{rowKey:"id",dataSource:D,columns:X,search:!1,options:!1,pagination:!1,editable:{type:"multiple",editableKeys:W,form:l,onValuesChange:function(e,t){G(t)}}}),Q.show&&Object(A.jsx)(y.a,{message:Q.msg,type:"error",showIcon:!0}),Object(A.jsx)(k.a,{style:{marginTop:16,width:"100%"},justify:"center",align:"middle",children:Object(A.jsx)(x.a,{type:"primary",style:{width:120},onClick:Object(s.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$();case 2:case"end":return e.stop()}}),e)}))),children:"\u63d0\u4ea4"})})]})}var F=[{path:"/",title:"SkuTable",component:Object(A.jsx)(S,{})}],N=function(e){Object(u.l)().pathname;return Object(A.jsx)("div",{className:"App",children:Object(A.jsx)(u.c,{children:F.map((function(e){var t=e.path,n=e.component;return Object(A.jsx)(u.a,{path:t,element:n},t)}))})})},T=n(345);c.a.render(Object(A.jsx)(i.a.StrictMode,{children:Object(A.jsx)(T.a,{children:Object(A.jsx)(N,{})})}),document.getElementById("root"))}},[[573,1,2]]]);
//# sourceMappingURL=main.727bd568.chunk.js.map